import numpy as np
import pandas as pd

dataset = "ref_zdr"

from model import rainFallRegressor

params = [[ 0.0262958913785 ,0.455533230862  ,-2.5905584223  , 1.19798      ],
[-0.0056959094655 ,0.264798269811  ,-2.46924886623 , 1.82866      ],
[-0.203436210052  ,0.0762959275498 ,-2.43147249227 , 2.32698000001],
[-0.51050536472   ,0.042928617627  ,-2.26232322113 , 2.75158000001],
[-0.833344253771  ,0.0493651644605 ,-1.99611237572 , 3.17314000001],
[-1.19514780364   ,0.0612906514636 ,-1.69423611273 , 3.61380000002],
[-1.59176009678   ,0.0597594511608 ,-1.38877569331 , 4.07902000001],
[-2.01828283016   ,0.0528086287208 ,-1.08876966024 , 4.56736      ],
[-2.47358108637   ,0.0487794338558 ,-0.790983300415, 5.07463999998],
[-2.95568926637   ,0.050145314971  ,-0.491890857885, 5.59901999996],
[-3.4592614324    ,0.0455602164764 ,-0.188879711211, 6.14057999994],
[-3.97178883395   ,0.0266450479022 ,0.114059140364 , 6.70231999992],
[-4.47542177897   ,0.031667028538  ,0.241113259219 , 7.27945999989],
[-4.96925767308   ,0.0270708295615 ,0.226073615754 , 7.86049999987],
[-5.4669711944    ,0.0258306346301 ,0.212791157171 , 8.43735999985]]


dfTrain = pd.read_csv("./data/xTrain_" + dataset + ".csv")
yTrain = pd.read_csv("./data/yTrain_" + dataset + ".csv")

subSet = yTrain.Id[int(len(yTrain) * .5)]

dfValid = dfTrain[dfTrain.Id > subSet]
yValid =  yTrain[yTrain.Id > subSet]


marshallPalmer = rainFallRegressor(eps=1e-5, nepoch=15)
marshallPalmer.resetRefZdr()
for p in params:
    marshallPalmer.c = p[0]
    marshallPalmer.a1= p[1]
    marshallPalmer.a2= p[2]
    marshallPalmer.d = p[3]
    print marshallPalmer.score(dfValid,yValid['Expected'])
    
# BEST:
# [-0.0056959094655 ,0.264798269811  ,-2.46924886623 , 1.82866      ]
# train 23.2606354012
# valid 21.4594944525
